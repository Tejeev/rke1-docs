"use strict";(self.webpackChunkrke_docs=self.webpackChunkrke_docs||[]).push([[6598],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),s=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(r),m=a,k=u["".concat(p,".").concat(m)]||u[m]||d[m]||i;return r?n.createElement(k,o(o({ref:t},c),{},{components:r})):n.createElement(k,o({ref:t},c))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=r[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},6873:function(e,t,r){r.r(t),r.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return d}});var n=r(7462),a=r(3366),i=(r(7294),r(3905)),o=["components"],l={title:"vSphere Configuration Reference",weight:3},p=void 0,s={unversionedId:"config-options/cloud-providers/vsphere/config-reference/config-reference",id:"config-options/cloud-providers/vsphere/config-reference/config-reference",title:"vSphere Configuration Reference",description:"This section shows an example of how to configure the vSphere cloud provider.",source:"@site/docs/config-options/cloud-providers/vsphere/config-reference/config-reference.md",sourceDirName:"config-options/cloud-providers/vsphere/config-reference",slug:"/config-options/cloud-providers/vsphere/config-reference/",permalink:"/config-options/cloud-providers/vsphere/config-reference/",draft:!1,editUrl:"https://github.com/kubewarden/docs/edit/main/docs/config-options/cloud-providers/vsphere/config-reference/config-reference.md",tags:[],version:"current",lastUpdatedAt:1660918540,formattedLastUpdatedAt:"8/19/2022",frontMatter:{title:"vSphere Configuration Reference",weight:3},sidebar:"mySidebar",previous:{title:"vSphere Cloud Provider",permalink:"/config-options/cloud-providers/vsphere/"},next:{title:"Enabling Disk UUIDs for vSphere VMs",permalink:"/config-options/cloud-providers/vsphere/enabling-uuid/"}},c={},d=[{value:"global",id:"global",level:3},{value:"virtual_center",id:"virtual_center",level:3},{value:"workspace",id:"workspace",level:3},{value:"disk",id:"disk",level:3},{value:"network",id:"network",level:3}],u={toc:d};function m(e){var t=e.components,r=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This section shows an example of how to configure the vSphere cloud provider."),(0,i.kt)("p",null,"The vSphere cloud provider must be enabled to allow dynamic provisioning of volumes."),(0,i.kt)("p",null,"For more details on deploying a Kubernetes cluster on vSphere, refer to the ",(0,i.kt)("a",{parentName:"p",href:"https://cloud-provider-vsphere.sigs.k8s.io/tutorials/kubernetes-on-vsphere-with-kubeadm.html"},"official cloud provider documentation.")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"}," ",(0,i.kt)("strong",{parentName:"p"},"Note:")," This documentation reflects the new vSphere Cloud Provider configuration schema introduced in Kubernetes v1.9 which differs from previous versions.")),(0,i.kt)("h1",{id:"vsphere-configuration-example"},"vSphere Configuration Example"),(0,i.kt)("p",null,"Given the following:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"VMs in the cluster are running in the same datacenter ",(0,i.kt)("inlineCode",{parentName:"li"},"eu-west-1")," managed by the vCenter ",(0,i.kt)("inlineCode",{parentName:"li"},"vc.example.com"),"."),(0,i.kt)("li",{parentName:"ul"},"The vCenter has a user ",(0,i.kt)("inlineCode",{parentName:"li"},"provisioner")," with password ",(0,i.kt)("inlineCode",{parentName:"li"},"secret")," with the required roles assigned, see ",(0,i.kt)("a",{parentName:"li",href:"#prerequisites"},"Prerequisites"),"."),(0,i.kt)("li",{parentName:"ul"},"The vCenter has a datastore named ",(0,i.kt)("inlineCode",{parentName:"li"},"ds-1")," which should be used to store the VMDKs for volumes."),(0,i.kt)("li",{parentName:"ul"},"A ",(0,i.kt)("inlineCode",{parentName:"li"},"vm/kubernetes")," folder exists in vCenter.")),(0,i.kt)("p",null,"The corresponding configuration for the provider would then be as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"rancher_kubernetes_engine_config:\n  (...)\n  cloud_provider:\n    name: vsphere\n    vsphereCloudProvider:\n      virtual_center:\n        vc.example.com:\n          user: provisioner\n          password: secret\n          port: 443\n          datacenters: /eu-west-1\n      workspace:\n        server: vc.example.com\n        folder: myvmfolder\n        default-datastore: ds-1\n        datacenter: /eu-west-1\n        resourcepool-path: /eu-west-1/host/hn1/resources/myresourcepool\n\n")),(0,i.kt)("h1",{id:"configuration-options"},"Configuration Options"),(0,i.kt)("p",null,"The vSphere configuration options are divided into 5 groups:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#global"},"global")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#virtual_center"},"virtual_center")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#workspace"},"workspace")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#disk"},"disk")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#network"},"network"))),(0,i.kt)("h3",{id:"global"},"global"),(0,i.kt)("p",null,"The main purpose of global options is to be able to define a common set of configuration parameters that will be inherited by all vCenters defined under the ",(0,i.kt)("inlineCode",{parentName:"p"},"virtual_center")," directive unless explicitly defined there."),(0,i.kt)("p",null,"Accordingly, the ",(0,i.kt)("inlineCode",{parentName:"p"},"global")," directive accepts the same configuration options that are available under the ",(0,i.kt)("inlineCode",{parentName:"p"},"virtual_center")," directive. Additionally it accepts a single parameter that can only be specified here:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"center"},"global Options"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Required"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"insecure-flag"),(0,i.kt)("td",{parentName:"tr",align:"center"},"boolean"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Set to ",(0,i.kt)("strong",{parentName:"td"},"true")," if the vCenter/ESXi uses a self-signed certificate.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"(...)\n    global:\n      insecure-flag: true\n")),(0,i.kt)("h3",{id:"virtual_center"},"virtual_center"),(0,i.kt)("p",null,"This configuration directive specifies the vCenters that are managing the nodes in the cluster. You must define at least one vCenter/ESXi server. If the nodes span multiple vCenters then all must be defined."),(0,i.kt)("p",null,"Each vCenter is defined by adding a new entry under the ",(0,i.kt)("inlineCode",{parentName:"p"},"virtual_center")," directive with the vCenter IP or FQDN as the name. All required parameters must be provided for each vCenter unless they are already defined under the ",(0,i.kt)("inlineCode",{parentName:"p"},"global")," directive."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"center"},"virtual_center Options"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Required"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"user"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"},"*"),(0,i.kt)("td",{parentName:"tr",align:"left"},"vCenter/ESXi user used to authenticate with this server.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"password"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"},"*"),(0,i.kt)("td",{parentName:"tr",align:"left"},"User's password.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"port"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Port to use to connect to this server. Defaults to 443.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"datacenters"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"},"*"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Comma-separated list of all datacenters in which cluster nodes are running in.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"soap-roundtrip-count"),(0,i.kt)("td",{parentName:"tr",align:"center"},"uint"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Round tripper count for API requests to the vCenter (num retries = value - 1).")))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"The following additional options (introduced in Kubernetes v1.11) are not yet supported in RKE.")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"center"},"virtual_center Options"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Required"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"secret-name"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Name of secret resource containing credential key/value pairs. Can be specified in lieu of user/password parameters.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"secret-namespace"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Namespace in which the secret resource was created in.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"ca-file"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Path to CA cert file used to verify the vCenter certificate.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"(...)\n    virtual_center:\n      172.158.111.1: {}  # This vCenter inherits all it's properties from global options\n      172.158.110.2:     # All required options are set explicitly\n        user: vc-user\n        password: othersecret\n        datacenters: eu-west-2\n")),(0,i.kt)("h3",{id:"workspace"},"workspace"),(0,i.kt)("p",null,"This configuration group specifies how storage for volumes is created in vSphere.\nThe following configuration options are available:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"center"},"workspace Options"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Required"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"server"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"},"*"),(0,i.kt)("td",{parentName:"tr",align:"left"},"IP or FQDN of the vCenter/ESXi that should be used for creating the volumes. Must match one of the vCenters defined under the ",(0,i.kt)("inlineCode",{parentName:"td"},"virtual_center")," directive.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"datacenter"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"},"*"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Name of the datacenter that should be used for creating volumes. For ESXi enter ",(0,i.kt)("em",{parentName:"td"},"ha-datacenter"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"folder"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"},"*"),(0,i.kt)("td",{parentName:"tr",align:"left"},'Path of folder in which to create dummy VMs used for volume provisioning (relative from the root folder in vCenter), e.g. "vm/kubernetes".')),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"default-datastore"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Name of default datastore to place VMDKs if neither datastore or storage policy are specified in the volume options of a PVC. If datastore is located in a storage folder or is a member of a datastore cluster, specify the full path.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"resourcepool-path"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Absolute or relative path to the resource pool where the dummy VMs for ",(0,i.kt)("a",{parentName:"td",href:"https://vmware.github.io/vsphere-storage-for-kubernetes/documentation/policy-based-mgmt.html"},"Storage policy based provisioning")," should be created. If a relative path is specified, it is resolved with respect to the datacenter's ",(0,i.kt)("em",{parentName:"td"},"host")," folder. Examples: ",(0,i.kt)("inlineCode",{parentName:"td"},"/<dataCenter>/host/<hostOrClusterName>/Resources/<poolName>"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"Resources/<poolName>"),". For standalone ESXi specify ",(0,i.kt)("inlineCode",{parentName:"td"},"Resources"),".")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"(...)\n    workspace:\n      server: 172.158.111.1 # matches IP of vCenter defined in the virtual_center block\n      datacenter: eu-west-1\n      folder: vm/kubernetes\n      default-datastore: ds-1\n")),(0,i.kt)("h3",{id:"disk"},"disk"),(0,i.kt)("p",null,"The following configuration options are available under the disk directive:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"center"},"disk Options"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Required"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"scsicontrollertype"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"SCSI controller type to use when attaching block storage to VMs. Must be one of: ",(0,i.kt)("em",{parentName:"td"},"lsilogic-sas")," or ",(0,i.kt)("em",{parentName:"td"},"pvscsi"),". Default: ",(0,i.kt)("em",{parentName:"td"},"pvscsi"),".")))),(0,i.kt)("h3",{id:"network"},"network"),(0,i.kt)("p",null,"The following configuration options are available under the network directive:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"center"},"network Options"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Required"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"public-network"),(0,i.kt)("td",{parentName:"tr",align:"center"},"string"),(0,i.kt)("td",{parentName:"tr",align:"center"}),(0,i.kt)("td",{parentName:"tr",align:"left"},"Name of public ",(0,i.kt)("strong",{parentName:"td"},"VM Network")," to which the VMs in the cluster are connected. Used to determine public IP addresses of VMs.")))))}m.isMDXComponent=!0}}]);