<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-os/os">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">Requirements | RKE1</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://http://rke.docs.rancher.com//os"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Requirements | RKE1"><meta data-rh="true" name="description" content="In this section:"><meta data-rh="true" property="og:description" content="In this section:"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="http://http://rke.docs.rancher.com//os"><link data-rh="true" rel="alternate" href="http://http://rke.docs.rancher.com//os" hreflang="en"><link data-rh="true" rel="alternate" href="http://http://rke.docs.rancher.com//os" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.52ec3bf5.css">
<link rel="preload" href="/assets/js/runtime~main.15f9ec57.js" as="script">
<link rel="preload" href="/assets/js/main.6fc4084f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-horizontal-rke.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-horizontal-rke.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__docs" href="/">Docs</a><a href="https://github.com/rancher/rke1-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Requirements</h1></header><p><strong>In this section:</strong> </p><ul><li><a href="#operating-system">Operating System</a><ul><li><a href="#general-linux-requirements">General Linux Requirements</a></li><li><a href="#suse-linux-enterprise-server-sles-opensuse">SUSE Linux Enterprise Server (SLES) / openSUSE</a><ul><li><a href="#using-upstream-docker">Using Upstream Docker</a></li><li><a href="#using-suse-opensuse-packaged-docker">Using SUSE/openSUSE packaged Docker</a></li><li><a href="#adding-the-software-repository-for-docker">Adding the Software Repository for Docker</a></li></ul></li><li><a href="#opensuse-microos-kubic-atomic">openSUSE MicroOS/Kubic (Atomic)</a><ul><li><a href="#opensuse-microos">openSUSE MicroOS</a></li><li><a href="#opensuse-kubic">openSUSE Kubic</a></li></ul></li><li><a href="#red-hat-enterprise-linux-rhel-oracle-linux-ol-centos">Red Hat Enterprise Linux (RHEL) / Oracle Linux (OL) / CentOS</a><ul><li><a href="#using-upstream-docker-1">Using upstream Docker</a></li><li><a href="#using-rhel-centos-packaged-docker">Using RHEL/CentOS packaged Docker</a></li></ul></li><li><a href="#red-hat-atomic">Red Hat Atomic</a><ul><li><a href="#openssh-version">OpenSSH version</a></li><li><a href="#creating-a-docker-group">Creating a Docker Group</a></li></ul></li><li><a href="#flatcar-container-linux">Flatcar Container Linux</a></li></ul></li><li><a href="#software">Software</a><ul><li><a href="#openssh">OpenSSH</a></li><li><a href="#kubernetes">Kubernetes</a></li><li><a href="#docker">Docker</a></li><li><a href="#installing-docker">Installing Docker</a></li><li><a href="#checking-the-installed-docker-version">Checking the Installed Docker Version</a></li></ul></li><li><a href="#hardware">Hardware</a><ul><li><a href="#worker-role">Worker Role</a></li><li><a href="#large-kubernetes-clusters">Large Kubernetes Clusters</a></li><li><a href="#etcd-clusters">Etcd clusters</a>  </li></ul></li><li><a href="#ports">Ports</a><ul><li><a href="#opening-port-tcp-6443-using-iptables">Opening port TCP/6443 using <code>iptables</code></a></li><li><a href="#opening-port-tcp-6443-using-firewalld">Opening port TCP/6443 using <code>firewalld</code></a></li></ul></li><li><a href="#ssh-server-configuration">SSH Server Configuration</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="operating-system">Operating System<a class="hash-link" href="#operating-system" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general-linux-requirements">General Linux Requirements<a class="hash-link" href="#general-linux-requirements" title="Direct link to heading">​</a></h3><p>RKE runs on almost any Linux OS with Docker installed. For details on which OS and Docker versions were tested with each version, refer to the <a href="https://rancher.com/support-maintenance-terms/" target="_blank" rel="noopener noreferrer">support maintenance terms.</a>.</p><ul><li><p><a href="/config-options/nodes#ssh-user">SSH user</a> - The SSH user used for node access must be a member of the <code>docker</code> group on the node:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">usermod -aG docker &lt;user_name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><blockquote><p><strong>Note:</strong> Users added to the <code>docker</code> group are granted effective root permissions on the host by means of the Docker API. Only choose a user that is intended for this purpose and has its credentials and access properly secured. </p></blockquote><p>   See <a href="https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user" target="_blank" rel="noopener noreferrer">Manage Docker as a non-root user</a> to see how you can configure access to Docker without using the <code>root</code> user.</p><ul><li><p>Swap should be disabled on any worker nodes</p></li><li><p>Please check the network plugin documentation for any additional requirements (for example, kernel modules)</p><ul><li><a href="https://docs.projectcalico.org/getting-started/kubernetes/requirements#kernel-dependencies" target="_blank" rel="noopener noreferrer">Calico</a></li><li><a href="https://github.com/flannel-io/flannel/tree/master/Documentation" target="_blank" rel="noopener noreferrer">Flannel</a></li><li>Canal (Combination Calico and Flannel)</li><li><a href="https://www.weave.works/docs/net/latest/install/installing-weave/" target="_blank" rel="noopener noreferrer">Weave</a></li></ul></li></ul><blockquote><p><strong>Note:</strong> If you or your cloud provider are using a custom minimal kernel, some required (network) kernel modules might not be present.</p></blockquote><ul><li>Following sysctl settings must be applied</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.bridge.bridge-nf-call-iptables=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="suse-linux-enterprise-server-sles--opensuse">SUSE Linux Enterprise Server (SLES) / openSUSE<a class="hash-link" href="#suse-linux-enterprise-server-sles--opensuse" title="Direct link to heading">​</a></h3><p>If you are using SUSE Linux Enterprise Server or openSUSE follow the instructions below.  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-upstream-docker">Using upstream Docker<a class="hash-link" href="#using-upstream-docker" title="Direct link to heading">​</a></h4><p>If you are using upstream Docker, the package name is <code>docker-ce</code> or <code>docker-ee</code>. You can check the installed package by executing:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rpm -q docker-ce</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using the upstream Docker packages, please follow <a href="https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user" target="_blank" rel="noopener noreferrer">Manage Docker as a non-root user</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-suseopensuse-packaged-docker">Using SUSE/openSUSE packaged docker<a class="hash-link" href="#using-suseopensuse-packaged-docker" title="Direct link to heading">​</a></h4><p>If you are using the Docker package supplied by SUSE/openSUSE, the package name is <code>docker</code>. You can check the installed package by executing:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rpm -q docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-the-software-repository-for-docker">Adding the Software repository for docker<a class="hash-link" href="#adding-the-software-repository-for-docker" title="Direct link to heading">​</a></h4><p>In SUSE Linux Enterprise Server 15 SP2 docker is found in the Containers module.<br>
<!-- -->This module will need to be added before istalling docker.  </p><p>To list available modules you can run SUSEConnect to list the extensions and the activation command  </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node:~ # SUSEConnect --list-extensions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">AVAILABLE EXTENSIONS AND MODULES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Basesystem Module 15 SP2 x86_64 (Activated)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Deactivate with: SUSEConnect -d -p sle-module-basesystem/15.2/x86_64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Containers Module 15 SP2 x86_64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Activate with: SUSEConnect -p sle-module-containers/15.2/x86_64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run this SUSEConnect command to activate the Containers module.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node:~ # SUSEConnect -p sle-module-containers/15.2/x86_64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Registering system to registration proxy https://rmt.seader.us</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Updating system details on https://rmt.seader.us ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Activating sle-module-containers 15.2 x86_64 ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-&gt; Adding service to system ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-&gt; Installing release package ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Successfully registered system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order to run docker cli commands with your user then you need to add this user to the <code>docker</code> group.
It is preferred not to use the root user for this.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">usermod -aG docker &lt;user_name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To verify that the user is correctly configured, log out of the node and login using SSH or your preferred method, and execute <code>docker ps</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ssh user@node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">user@node:~&gt; docker ps</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONTAINER ID        IMAGE       COMMAND             CREATED             STATUS              PORTS               NAMES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">user@node:~&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="opensuse-microoskubic-atomic">openSUSE MicroOS/Kubic (Atomic)<a class="hash-link" href="#opensuse-microoskubic-atomic" title="Direct link to heading">​</a></h3><p>Consult the project pages for openSUSE MicroOS and Kubic for installation  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="opensuse-microos">openSUSE MicroOS<a class="hash-link" href="#opensuse-microos" title="Direct link to heading">​</a></h4><p>Designed to host container workloads with automated administration &amp; patching. Installing openSUSE MicroOS you get a quick, small environment for deploying Containers, or any other workload that benefits from Transactional Updates. As rolling release distribution the software is always up-to-date.<br>
<a href="https://microos.opensuse.org" target="_blank" rel="noopener noreferrer">https://microos.opensuse.org</a>  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="opensuse-kubic">openSUSE Kubic<a class="hash-link" href="#opensuse-kubic" title="Direct link to heading">​</a></h4><p>Based on openSUSE MicroOS, designed with the same things in mind but is focused on being a Certified Kubernetes Distribution.<br>
<a href="https://kubic.opensuse.org" target="_blank" rel="noopener noreferrer">https://kubic.opensuse.org</a><br>
<!-- -->Installation instructions:<br>
<a href="https://kubic.opensuse.org/blog/2021-02-08-MicroOS-Kubic-Rancher-RKE/" target="_blank" rel="noopener noreferrer">https://kubic.opensuse.org/blog/2021-02-08-MicroOS-Kubic-Rancher-RKE/</a>  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="red-hat-enterprise-linux-rhel--oracle-linux-ol--centos">Red Hat Enterprise Linux (RHEL) / Oracle Linux (OL) / CentOS<a class="hash-link" href="#red-hat-enterprise-linux-rhel--oracle-linux-ol--centos" title="Direct link to heading">​</a></h3><p>If using Red Hat Enterprise Linux, Oracle Linux or CentOS, you cannot use the <code>root</code> user as <a href="/config-options/nodes#ssh-user">SSH user</a> due to <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1527565" target="_blank" rel="noopener noreferrer">Bugzilla 1527565</a>. Please follow the instructions below how to setup Docker correctly, based on the way you installed Docker on the node.</p><blockquote><p><strong>Note:</strong> In RHEL 8.4, two extra services are included on the NetworkManager: <code>nm-cloud-setup.service</code> and <code>nm-cloud-setup.timer</code>. These services add a routing table that interferes with the CNI plugin&#x27;s configuration. If these services are enabled, you must disable them using the command below, and then reboot the node to restore connectivity:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  systemctl disable nm-cloud-setup.service nm-cloud-setup.timer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  reboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In addition, the default firewall settings of RHEL 8.4 prevent RKE1 pods from reaching out to Rancher to connect to the cluster agent. To allow Docker containers to reach out to the internet and connect to Rancher, make the following updates to the firewall settings:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  firewall-cmd --zone=public  --add-masquerade --permanent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  firewall-cmd --reload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-upstream-docker-1">Using upstream Docker<a class="hash-link" href="#using-upstream-docker-1" title="Direct link to heading">​</a></h4><p>If you are using upstream Docker, the package name is <code>docker-ce</code> or <code>docker-ee</code>. You can check the installed package by executing:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rpm -q docker-ce</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using the upstream Docker packages, please follow <a href="https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user" target="_blank" rel="noopener noreferrer">Manage Docker as a non-root user</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-rhelcentos-packaged-docker">Using RHEL/CentOS packaged Docker<a class="hash-link" href="#using-rhelcentos-packaged-docker" title="Direct link to heading">​</a></h4><p>If you are using the Docker package supplied by Red Hat / CentOS, the package name is <code>docker</code>. You can check the installed package by executing:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rpm -q docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you are using the Docker package supplied by Red Hat / CentOS, the <code>dockerroot</code> group is automatically added to the system. You will need to edit (or create) <code>/etc/docker/daemon.json</code> to include the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;group&quot;: &quot;dockerroot&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Restart Docker after editing or creating the file. After restarting Docker, you can check the group permission of the Docker socket (<code>/var/run/docker.sock</code>), which should show <code>dockerroot</code> as group:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">srw-rw----. 1 root dockerroot 0 Jul  4 09:57 /var/run/docker.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Add the SSH user you want to use to this group, this can&#x27;t be the <code>root</code> user.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">usermod -aG dockerroot &lt;user_name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To verify that the user is correctly configured, log out of the node and login with your SSH user, and execute <code>docker ps</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ssh &lt;user_name&gt;@node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker ps</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="red-hat-atomic">Red Hat Atomic<a class="hash-link" href="#red-hat-atomic" title="Direct link to heading">​</a></h3><p>Before trying to use RKE with Red Hat Atomic nodes, there are a couple of updates to the OS that need to occur in order to get RKE working.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="openssh-version">OpenSSH version<a class="hash-link" href="#openssh-version" title="Direct link to heading">​</a></h4><p>By default, Atomic hosts ship with OpenSSH 6.4, which doesn&#x27;t support SSH tunneling, which is a core RKE requirement. If you upgrade to the latest version of OpenSSH supported by Atomic, it will correct the SSH issue.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-docker-group">Creating a Docker Group<a class="hash-link" href="#creating-a-docker-group" title="Direct link to heading">​</a></h4><p>By default, Atomic hosts do not come with a Docker group. You can update the ownership of the Docker socket by enabling the specific user in order to launch RKE.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># chown &lt;user&gt; /var/run/docker.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="flatcar-container-linux">Flatcar Container Linux<a class="hash-link" href="#flatcar-container-linux" title="Direct link to heading">​</a></h3><p>When using Flatcar Container Linux nodes, it is required to use the following configuration in the cluster configuration file:</p><p>{{% tabs %}}
{{% tab &quot;Canal&quot;%}}</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">rancher_kubernetes_engine_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">network</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> canal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">canal_flex_volume_plugin_dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /opt/kubernetes/kubelet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">plugins/volume/exec/nodeagent~uds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">flannel_backend_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> vxlan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">kube-controller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">extra_args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">flex-volume-plugin-dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /opt/kubernetes/kubelet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">plugins/volume/exec/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>{{% /tab %}}</p><p>{{% tab &quot;Calico&quot;%}}</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">rancher_kubernetes_engine_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">network</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> calico</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">calico_flex_volume_plugin_dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /opt/kubernetes/kubelet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">plugins/volume/exec/nodeagent~uds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">flannel_backend_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> vxlan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">kube-controller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">extra_args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">flex-volume-plugin-dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /opt/kubernetes/kubelet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">plugins/volume/exec/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>{{% /tab %}}
{{% /tabs %}}</p><p>It is also required to enable the Docker service, you can enable the Docker service using the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl enable docker.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="software">Software<a class="hash-link" href="#software" title="Direct link to heading">​</a></h2><p>This section describes the requirements for Docker, Kubernetes, and SSH.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="openssh">OpenSSH<a class="hash-link" href="#openssh" title="Direct link to heading">​</a></h3><p>In order to SSH into each node, OpenSSH 7.0+ must be installed on each node.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes">Kubernetes<a class="hash-link" href="#kubernetes" title="Direct link to heading">​</a></h3><p>Refer to the <a href="https://github.com/rancher/rke/releases" target="_blank" rel="noopener noreferrer">RKE release notes</a> for the supported versions of Kubernetes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker">Docker<a class="hash-link" href="#docker" title="Direct link to heading">​</a></h3><p>Each Kubernetes version supports different Docker versions. The Kubernetes release notes contain the <a href="https://kubernetes.io/docs/setup/release/notes/#dependencies" target="_blank" rel="noopener noreferrer">current list</a> of validated Docker versions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-docker">Installing Docker<a class="hash-link" href="#installing-docker" title="Direct link to heading">​</a></h3><p>Refer to <a href="/{{&lt;baseurl&gt;}}/rancher/v2.5/en/installation/requirements/installing-docker">Installing Docker</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checking-the-installed-docker-version">Checking the Installed Docker Version<a class="hash-link" href="#checking-the-installed-docker-version" title="Direct link to heading">​</a></h3><p>Confirm that a Kubernetes supported version of Docker is installed on your machine, by running <code>docker version --format &#x27;{{.Server.Version}}&#x27;</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hardware">Hardware<a class="hash-link" href="#hardware" title="Direct link to heading">​</a></h2><p>This section describes the hardware requirements for the worker role, large Kubernetes clusters, and etcd clusters.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="worker-role">Worker Role<a class="hash-link" href="#worker-role" title="Direct link to heading">​</a></h3><p>The hardware requirements for nodes with the <code>worker</code> role mostly depend on your workloads. The minimum to run the Kubernetes node components is 1 CPU (core) and 1GB of memory. </p><p>Regarding CPU and memory, it is recommended that the different planes of Kubernetes clusters (etcd, controlplane, and workers) should be hosted on different nodes so that they can scale separately from each other.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="large-kubernetes-clusters">Large Kubernetes Clusters<a class="hash-link" href="#large-kubernetes-clusters" title="Direct link to heading">​</a></h3><p>For hardware recommendations for large Kubernetes clusters, refer to the official Kubernetes documentation on <a href="https://kubernetes.io/docs/setup/best-practices/cluster-large/" target="_blank" rel="noopener noreferrer">building large clusters</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="etcd-clusters">Etcd Clusters<a class="hash-link" href="#etcd-clusters" title="Direct link to heading">​</a></h3><p>For hardware recommendations for etcd clusters in production, refer to the official <a href="https://etcd.io/docs/v3.5/op-guide/hardware/" target="_blank" rel="noopener noreferrer">etcd documentation</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ports">Ports<a class="hash-link" href="#ports" title="Direct link to heading">​</a></h2><p>{{&lt; ports-rke-nodes &gt;}}
{{&lt; requirements_ports_rke &gt;}}</p><p>If you are using an external firewall, make sure you have this port opened between the machine you are using to run <code>rke</code> and the nodes that you are going to use in the cluster.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="opening-port-tcp6443-using-iptables">Opening port TCP/6443 using <code>iptables</code><a class="hash-link" href="#opening-port-tcp6443-using-iptables" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Open TCP/6443 for all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -A INPUT -p tcp --dport 6443 -j ACCEPT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Open TCP/6443 for one specific IP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -A INPUT -p tcp -s your_ip_here --dport 6443 -j ACCEPT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="opening-port-tcp6443-using-firewalld">Opening port TCP/6443 using <code>firewalld</code><a class="hash-link" href="#opening-port-tcp6443-using-firewalld" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Open TCP/6443 for all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">firewall-cmd --zone=public --add-port=6443/tcp --permanent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">firewall-cmd --reload</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Open TCP/6443 for one specific IP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">firewall-cmd --permanent --zone=public --add-rich-rule=&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rule family=&quot;ipv4&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  source address=&quot;your_ip_here/32&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  port protocol=&quot;tcp&quot; port=&quot;6443&quot; accept&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">firewall-cmd --reload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-server-configuration">SSH Server Configuration<a class="hash-link" href="#ssh-server-configuration" title="Direct link to heading">​</a></h2><p>Your SSH server system-wide configuration file, located at <code>/etc/ssh/sshd_config</code>, must include this line that allows TCP forwarding:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AllowTcpForwarding yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rke1-docs/edit/main/docs/os/os.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-01-26T23:02:21.000Z">1/26/2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#operating-system" class="table-of-contents__link toc-highlight">Operating System</a><ul><li><a href="#general-linux-requirements" class="table-of-contents__link toc-highlight">General Linux Requirements</a></li><li><a href="#suse-linux-enterprise-server-sles--opensuse" class="table-of-contents__link toc-highlight">SUSE Linux Enterprise Server (SLES) / openSUSE</a></li><li><a href="#opensuse-microoskubic-atomic" class="table-of-contents__link toc-highlight">openSUSE MicroOS/Kubic (Atomic)</a></li><li><a href="#red-hat-enterprise-linux-rhel--oracle-linux-ol--centos" class="table-of-contents__link toc-highlight">Red Hat Enterprise Linux (RHEL) / Oracle Linux (OL) / CentOS</a></li><li><a href="#red-hat-atomic" class="table-of-contents__link toc-highlight">Red Hat Atomic</a></li><li><a href="#flatcar-container-linux" class="table-of-contents__link toc-highlight">Flatcar Container Linux</a></li></ul></li><li><a href="#software" class="table-of-contents__link toc-highlight">Software</a><ul><li><a href="#openssh" class="table-of-contents__link toc-highlight">OpenSSH</a></li><li><a href="#kubernetes" class="table-of-contents__link toc-highlight">Kubernetes</a></li><li><a href="#docker" class="table-of-contents__link toc-highlight">Docker</a></li><li><a href="#installing-docker" class="table-of-contents__link toc-highlight">Installing Docker</a></li><li><a href="#checking-the-installed-docker-version" class="table-of-contents__link toc-highlight">Checking the Installed Docker Version</a></li></ul></li><li><a href="#hardware" class="table-of-contents__link toc-highlight">Hardware</a><ul><li><a href="#worker-role" class="table-of-contents__link toc-highlight">Worker Role</a></li><li><a href="#large-kubernetes-clusters" class="table-of-contents__link toc-highlight">Large Kubernetes Clusters</a></li><li><a href="#etcd-clusters" class="table-of-contents__link toc-highlight">Etcd Clusters</a></li></ul></li><li><a href="#ports" class="table-of-contents__link toc-highlight">Ports</a><ul><li><a href="#opening-port-tcp6443-using-iptables" class="table-of-contents__link toc-highlight">Opening port TCP/6443 using <code>iptables</code></a></li><li><a href="#opening-port-tcp6443-using-firewalld" class="table-of-contents__link toc-highlight">Opening port TCP/6443 using <code>firewalld</code></a></li></ul></li><li><a href="#ssh-server-configuration" class="table-of-contents__link toc-highlight">SSH Server Configuration</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.15f9ec57.js"></script>
<script src="/assets/js/main.6fc4084f.js"></script>
</body>
</html>