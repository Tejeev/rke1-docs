<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-config-options/services/services">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">Default Kubernetes Services | RKE1</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rancher.github.io//rke1-docs/config-options/services"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Default Kubernetes Services | RKE1"><meta data-rh="true" name="description" content="To deploy Kubernetes, RKE deploys several default Kubernetes services. Read about etcd, kube-api server, kubelet, kube-proxy and more"><meta data-rh="true" property="og:description" content="To deploy Kubernetes, RKE deploys several default Kubernetes services. Read about etcd, kube-api server, kubelet, kube-proxy and more"><link data-rh="true" rel="icon" href="/rke1-docs/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rancher.github.io//rke1-docs/config-options/services"><link data-rh="true" rel="alternate" href="https://rancher.github.io//rke1-docs/config-options/services" hreflang="en"><link data-rh="true" rel="alternate" href="https://rancher.github.io//rke1-docs/config-options/services" hreflang="x-default"><link rel="stylesheet" href="/rke1-docs/assets/css/styles.e4d8ae4d.css">
<link rel="preload" href="/rke1-docs/assets/js/runtime~main.dd12ace3.js" as="script">
<link rel="preload" href="/rke1-docs/assets/js/main.7e5028ef.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rke1-docs/"><div class="navbar__logo"><img src="/rke1-docs/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/rke1-docs/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/rke1-docs/">Docs</a><a href="https://github.com/rancher/rke1-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rke1-docs/">Overview of RKE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/rke1-docs/installation">RKE Kubernetes Installation</a><button aria-label="Toggle the collapsible sidebar category &#x27;RKE Kubernetes Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/rke1-docs/upgrades">Upgrades</a><button aria-label="Toggle the collapsible sidebar category &#x27;Upgrades&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rke1-docs/kubeconfig">Kubeconfig File</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/rke1-docs/etcd-snapshots">Backups and Disaster Recovery</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backups and Disaster Recovery&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rke1-docs/cert-mgmt">Certificate Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rke1-docs/managing-clusters">Adding and Removing Nodes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/rke1-docs/config-options">Kubernetes Configuration Options</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Configuration Options&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/nodes">Nodes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/private-registries">Private Registries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/bastion-host">Bastion/Jump Host Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/system-images">System Images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/services/external-etcd">External etcd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/services/services-extras">Extra Args, Extra Binds, and Extra Environment Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rke1-docs/config-options/services">Default Kubernetes Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/secrets-encryption">Encrypting Secret Data at Rest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/authentication">Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/authorization">Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/rate-limiting">Rate Limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/cloud-providers/aws">AWS Cloud Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/cloud-providers/azure">Azure Cloud Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/cloud-providers">Cloud Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/cloud-providers/custom">Custom Cloud Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/cloud-providers/openstack">OpenStack Cloud Provider</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/rke1-docs/config-options/cloud-providers/vsphere">vSphere Cloud Provider</a><button aria-label="Toggle the collapsible sidebar category &#x27;vSphere Cloud Provider&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/audit-log">Audit Log</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rke1-docs/config-options/dual-stack">Dual-stack</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rke1-docs/example-yamls">Example Cluster.ymls</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/rke1-docs/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rke1-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/rke1-docs/config-options"><span itemprop="name">Kubernetes Configuration Options</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Default Kubernetes Services</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Default Kubernetes Services</h1></header><p>To deploy Kubernetes, RKE deploys several core components or services in Docker containers on the nodes. Based on the roles of the node, the containers deployed may be different.</p><blockquote><p><strong>Note:</strong> All services support <b>additional custom arguments, Docker mount binds, and extra environment variables.</b> </p><p>To configure advanced options for Kubernetes services such as <code>kubelet</code>, <code>kube-controller</code>, and <code>kube-apiserver</code> that are not documented below, see the <a href="/rke1-docs/config-options/config-options/services/services-extras"><code>extra_args</code> documentation</a> for more details.</p></blockquote><table><thead><tr><th>Component</th><th>Services key name in cluster.yml</th></tr></thead><tbody><tr><td>etcd</td><td><code>etcd</code></td></tr><tr><td>kube-apiserver</td><td><code>kube-api</code></td></tr><tr><td>kube-controller-manager</td><td><code>kube-controller</code></td></tr><tr><td>kubelet</td><td><code>kubelet</code></td></tr><tr><td>kube-scheduler</td><td><code>scheduler</code></td></tr><tr><td>kube-proxy</td><td><code>kubeproxy</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="etcd">etcd<a class="hash-link" href="#etcd" title="Direct link to heading">​</a></h2><p>Kubernetes uses <a href="https://etcd.io/" target="_blank" rel="noopener noreferrer">etcd</a> as a store for cluster state and data. Etcd is a reliable, consistent and distributed key-value store.</p><p>RKE supports running etcd in a single node mode or in HA cluster mode. It also supports adding and removing etcd nodes to the cluster.</p><p>You can enable etcd to <a href="/rke1-docs/config-options/etcd-snapshots#recurring-snapshots">take recurring snapshots</a>. These snapshots can be used to <a href="/rke1-docs/config-options/etcd-snapshots#etcd-disaster-recovery">restore etcd</a>.</p><p>By default, RKE will deploy a new etcd service, but you can also run Kubernetes with an <a href="/rke1-docs/config-options/config-options/services/external-etcd">external etcd service</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-api-server">Kubernetes API Server<a class="hash-link" href="#kubernetes-api-server" title="Direct link to heading">​</a></h2><blockquote><p><strong>Note for Rancher 2 users</strong> If you are configuring Cluster Options using a <a href="/rke1-docs/config-options/{{&lt;baseurl&gt;}}/rancher/v2.x/en/cluster-provisioning/rke-clusters/options#cluster-config-file">Config File</a> when creating <a href="/rke1-docs/config-options/{{&lt;baseurl&gt;}}/rancher/v2.x/en/cluster-provisioning/rke-clusters">Rancher Launched Kubernetes</a>, the names of services should contain underscores only: <code>kube_api</code>. This only applies to Rancher v2.0.5 and v2.0.6.</p></blockquote><p>The <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/" target="_blank" rel="noopener noreferrer">Kubernetes API</a> REST service, which handles requests and data for all Kubernetes objects and provide shared state for all the other Kubernetes components.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">kube-api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># IP range for any services created on Kubernetes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This must match the service_cluster_ip_range in kube-controller</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">service_cluster_ip_range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.43.0.0/16</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Expose a different port range for NodePort services</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">service_node_port_range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 30000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token number" style="color:rgb(247, 140, 108)">32767</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">pod_security_policy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Enable AlwaysPullImages Admission controller plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Available as of v0.2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">always_pull_images</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">secrets_encryption_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-api-server-options">Kubernetes API Server Options<a class="hash-link" href="#kubernetes-api-server-options" title="Direct link to heading">​</a></h3><p>RKE supports the following options for the <code>kube-api</code> service :</p><ul><li><strong>Service Cluster IP Range</strong> (<code>service_cluster_ip_range</code>) - This is the virtual IP address that will be assigned to services created on Kubernetes. By default, the service cluster IP range is <code>10.43.0.0/16</code>. If you change this value, then it must also be set with the same value on the Kubernetes Controller Manager (<code>kube-controller</code>).</li><li><strong>Node Port Range</strong> (<code>service_node_port_range</code>) - The port range to be used for Kubernetes services created with the <a href="https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types" target="_blank" rel="noopener noreferrer">type</a> <code>NodePort</code>. By default, the port range is <code>30000-32767</code>.</li><li><strong>Pod Security Policy</strong> (<code>pod_security_policy</code>) - An option to enable the <a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/" target="_blank" rel="noopener noreferrer">Kubernetes Pod Security Policy</a>. By default, we do not enable pod security policies as it is set to <code>false</code>.<blockquote><p><strong>Note:</strong> If you set <code>pod_security_policy</code> value to <code>true</code>, RKE will configure an  open policy to allow any pods to work on the cluster. You will need to configure your own policies to fully utilize PSP.</p></blockquote></li><li><strong>Always Pull Images</strong> (<code>always_pull_images</code>) - Enable <code>AlwaysPullImages</code> Admission controller plugin.  Enabling <code>AlwaysPullImages</code> is a security best practice. It forces Kubernetes to validate the image and pull credentials with the remote image registry. Local image layer cache will still be used, but it does add a small bit of overhead when launching containers to pull and compare image hashes. <em>Note: Available as of v0.2.0</em></li><li><strong>Secrets Encryption Config</strong> (<code>secrets_encryption_config</code>) - Manage Kubernetes at-rest data encryption. Documented <a href="/rke1-docs/config-options/{{&lt;baseurl&gt;}}//rke/latest/en/config-options/secrets-encryption">here</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-controller-manager">Kubernetes Controller Manager<a class="hash-link" href="#kubernetes-controller-manager" title="Direct link to heading">​</a></h2><blockquote><p><strong>Note for Rancher 2 users</strong> If you are configuring Cluster Options using a <a href="/rke1-docs/config-options/{{&lt;baseurl&gt;}}/rancher/v2.x/en/cluster-provisioning/rke-clusters/options#cluster-config-file">Config File</a> when creating <a href="/rke1-docs/config-options/{{&lt;baseurl&gt;}}/rancher/v2.x/en/cluster-provisioning/rke-clusters">Rancher Launched Kubernetes</a>, the names of services should contain underscores only: <code>kube_controller</code>. This only applies to Rancher v2.0.5 and v2.0.6.</p></blockquote><p>The <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/" target="_blank" rel="noopener noreferrer">Kubernetes Controller Manager</a> service is the component responsible for running Kubernetes main control loops. The controller manager monitors the cluster desired state through the Kubernetes API server and makes the necessary changes to the current state to reach the desired state.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">kube-controller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># CIDR pool used to assign IP addresses to pods in the cluster</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cluster_cidr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.42.0.0/16</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># IP range for any services created on Kubernetes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This must match the service_cluster_ip_range in kube-api</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">service_cluster_ip_range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.43.0.0/16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-controller-manager-options">Kubernetes Controller Manager Options<a class="hash-link" href="#kubernetes-controller-manager-options" title="Direct link to heading">​</a></h3><p>RKE supports the following options for the <code>kube-controller</code> service:</p><ul><li><strong>Cluster CIDR</strong> (<code>cluster_cidr</code>) - The CIDR pool used to assign IP addresses to pods in the cluster. By default, each node in the cluster is assigned a <code>/24</code> network from this pool for pod IP assignments. The default value for this option is <code>10.42.0.0/16</code>.</li><li><strong>Service Cluster IP Range</strong> (<code>service_cluster_ip_range</code>) - This is the virtual IP address that will be assigned to services created on Kubernetes. By default, the service cluster IP range is <code>10.43.0.0/16</code>. If you change this value, then it must also be set with the same value on the Kubernetes API server (<code>kube-api</code>).</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubelet">Kubelet<a class="hash-link" href="#kubelet" title="Direct link to heading">​</a></h2><p>The <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/" target="_blank" rel="noopener noreferrer">kubelet</a> services acts as a &quot;node agent&quot; for Kubernetes. It runs on all nodes deployed by RKE, and gives Kubernetes the ability to manage the container runtime on the node.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">kubelet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Base domain for the cluster</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">cluster_domain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cluster.local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># IP address for the DNS service endpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">cluster_dns_server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.43.0.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Fail if swap is on</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">fail_swap_on</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate per node serving certificate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">generate_serving_certificate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubelet-options">Kubelet Options<a class="hash-link" href="#kubelet-options" title="Direct link to heading">​</a></h3><p>RKE supports the following options for the <code>kubelet</code> service:</p><ul><li><strong>Cluster Domain</strong> (<code>cluster_domain</code>) - The <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/" target="_blank" rel="noopener noreferrer">base domain</a> for the cluster. All services and DNS records created on the cluster. By default, the domain is set to <code>cluster.local</code>.</li><li><strong>Cluster DNS Server</strong> (<code>cluster_dns_server</code>) - The IP address assigned to the DNS service endpoint within the cluster. DNS queries will be sent to this IP address which is used by KubeDNS. The default value for this option is <code>10.43.0.10</code></li><li><strong>Fail if Swap is On</strong> (<code>fail_swap_on</code>) - In Kubernetes, the default behavior for the kubelet is to <strong>fail</strong> if swap is enabled on the node. RKE does <strong>not</strong> follow this default and allows deployments on nodes with swap enabled. By default, the value is <code>false</code>. If you&#x27;d like to revert to the default kubelet behavior, set this option to <code>true</code>.  </li><li><strong>Generate Serving Certificate</strong> (<code>generate_serving_certificate</code>) - Generate a certificate signed by the <code>kube-ca</code> Certificate Authority for the kubelet to use as a server certificate. The default value for this option is <code>false</code>. Before enabling this option, please read <a href="#kubelet-serving-certificate-requirements">the requirements</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubelet-serving-certificate-requirements">Kubelet Serving Certificate Requirements<a class="hash-link" href="#kubelet-serving-certificate-requirements" title="Direct link to heading">​</a></h3><p>If <code>hostname_override</code> is configured for one or more nodes in <code>cluster.yml</code>, please make sure the correct IP address is configured in <code>address</code> (and the internal address in <code>internal_address</code>) to make sure the generated certificate contains the correct IP address(es).</p><p>An example of an error situation is an EC2 instance where the the public IP address is configured in <code>address</code>, and <code>hostname_override</code> is used, the connection between <code>kube-apiserver</code> and <code>kubelet</code> will fail because the <code>kubelet</code> will be contacted on the private IP address and the generated certificate will not be valid (the error <code>x509: certificate is valid for value_in_address, not private_ip</code> will be seen). The resolution is to provide the internal IP address in <code>internal_address</code>.</p><p>For more information on host overrides, refer to the <a href="/rke1-docs/config-options/config-options/nodes#overriding-the-hostname">node configuration page.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-scheduler">Kubernetes Scheduler<a class="hash-link" href="#kubernetes-scheduler" title="Direct link to heading">​</a></h2><p>The <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/" target="_blank" rel="noopener noreferrer">Kubernetes Scheduler</a> service is responsible for scheduling cluster workloads based on various configurations, metrics, resource requirements and workload-specific requirements.</p><p>Currently, RKE doesn&#x27;t support any specific options for the <code>scheduler</code> service.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-network-proxy">Kubernetes Network Proxy<a class="hash-link" href="#kubernetes-network-proxy" title="Direct link to heading">​</a></h2><p>The <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/" target="_blank" rel="noopener noreferrer">Kubernetes network proxy</a> service runs on all nodes and manages endpoints created by Kubernetes for TCP/UDP ports.</p><p>Currently, RKE doesn&#x27;t support any specific options for the <code>kubeproxy</code> service.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rke1-docs/edit/main/docs/config-options/services/services.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-10-11T16:58:25.000Z">10/11/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/rke1-docs/config-options/services/services-extras"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Extra Args, Extra Binds, and Extra Environment Variables</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rke1-docs/config-options/secrets-encryption"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Encrypting Secret Data at Rest</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#etcd" class="table-of-contents__link toc-highlight">etcd</a></li><li><a href="#kubernetes-api-server" class="table-of-contents__link toc-highlight">Kubernetes API Server</a><ul><li><a href="#kubernetes-api-server-options" class="table-of-contents__link toc-highlight">Kubernetes API Server Options</a></li></ul></li><li><a href="#kubernetes-controller-manager" class="table-of-contents__link toc-highlight">Kubernetes Controller Manager</a><ul><li><a href="#kubernetes-controller-manager-options" class="table-of-contents__link toc-highlight">Kubernetes Controller Manager Options</a></li></ul></li><li><a href="#kubelet" class="table-of-contents__link toc-highlight">Kubelet</a><ul><li><a href="#kubelet-options" class="table-of-contents__link toc-highlight">Kubelet Options</a></li><li><a href="#kubelet-serving-certificate-requirements" class="table-of-contents__link toc-highlight">Kubelet Serving Certificate Requirements</a></li></ul></li><li><a href="#kubernetes-scheduler" class="table-of-contents__link toc-highlight">Kubernetes Scheduler</a></li><li><a href="#kubernetes-network-proxy" class="table-of-contents__link toc-highlight">Kubernetes Network Proxy</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/rke1-docs/assets/js/runtime~main.dd12ace3.js"></script>
<script src="/rke1-docs/assets/js/main.7e5028ef.js"></script>
</body>
</html>