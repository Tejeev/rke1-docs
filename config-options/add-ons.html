<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-config-options/add-ons/add-ons">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">Add-Ons | RKE1</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rancher.github.io//rke1-docs/config-options/add-ons"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Add-Ons | RKE1"><meta data-rh="true" name="description" content="RKE supports configuring pluggable add-ons in the cluster YML. Add-ons are used to deploy several cluster components including:"><meta data-rh="true" property="og:description" content="RKE supports configuring pluggable add-ons in the cluster YML. Add-ons are used to deploy several cluster components including:"><link data-rh="true" rel="icon" href="/rke1-docs/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rancher.github.io//rke1-docs/config-options/add-ons"><link data-rh="true" rel="alternate" href="https://rancher.github.io//rke1-docs/config-options/add-ons" hreflang="en"><link data-rh="true" rel="alternate" href="https://rancher.github.io//rke1-docs/config-options/add-ons" hreflang="x-default"><link rel="stylesheet" href="/rke1-docs/assets/css/styles.e4d8ae4d.css">
<link rel="preload" href="/rke1-docs/assets/js/runtime~main.dd12ace3.js" as="script">
<link rel="preload" href="/rke1-docs/assets/js/main.7e5028ef.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rke1-docs/"><div class="navbar__logo"><img src="/rke1-docs/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/rke1-docs/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__docs" href="/rke1-docs/">Docs</a><a href="https://github.com/rancher/rke1-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><div class="theme-doc-markdown markdown"><header><h1>Add-Ons</h1></header><p>RKE supports configuring pluggable add-ons in the cluster YML. Add-ons are used to deploy several cluster components including:</p><ul><li><a href="/rke1-docs/config-options/config-options/add-ons/network-plugins">Network plug-ins</a></li><li><a href="/rke1-docs/config-options/config-options/add-ons/ingress-controllers">Ingress controller</a></li><li><a href="/rke1-docs/config-options/config-options/add-ons/dns">DNS provider</a></li><li><a href="/rke1-docs/config-options/config-options/add-ons/metrics-server">Metrics Server</a></li></ul><p>These add-ons require images that can be found under the <a href="/rke1-docs/config-options/config-options/system-images"><code>system_images</code> directive</a>. For each Kubernetes version, there are default images associated with each add-on, but these can be overridden by changing the image tag in <code>system_images</code>.</p><p>There are a few things worth noting:</p><ul><li>In addition to these pluggable add-ons, you can specify an add-on that you want deployed after the cluster deployment is complete.</li><li>As of v0.1.8, RKE will update an add-on if it is the same name.</li><li>Before v0.1.8, update any add-ons by using <code>kubectl edit</code>.</li></ul><ul><li><a href="#critical-and-non-critical-add-ons">Critical and Non-Critical Add-ons</a></li><li><a href="#add-on-deployment-jobs">Add-on Deployment Jobs</a></li><li><a href="#add-on-placement">Add-on Placement</a></li><li><a href="#tolerations">Tolerations</a></li></ul><h1>Critical and Non-Critical Add-ons</h1><p>As of version v0.1.7, add-ons are split into two categories:</p><ul><li><p><strong>Critical add-ons:</strong> If these add-ons fail to deploy for any reason, RKE will error out. All system add-ons, such as the <a href="/rke1-docs/config-options/config-options/add-ons/network-plugins">network plug-in</a>, KubeDNS, and <a href="/rke1-docs/config-options/config-options/add-ons/ingress-controllers">ingress controllers</a>, are considered critical.</p></li><li><p><strong>Non-critical add-ons:</strong> If these add-ons fail to deploy, RKE will only log a warning and continue deploying any other add-ons. <a href="/rke1-docs/config-options/config-options/add-ons/user-defined-add-ons">User-defined add-ons</a> are considered non-critical.</p></li></ul><h1>Add-on Deployment Jobs</h1><p>RKE uses Kubernetes jobs to deploy add-ons. In some cases, add-ons deployment takes longer than expected. As of with version v0.1.7, RKE provides an option to control the job check timeout in seconds. This timeout is set at the cluster level.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">addon_job_timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Add-on Placement</h1><p><em>Applies to v0.2.3 and higher</em></p><table><thead><tr><th>Component</th><th>nodeAffinity nodeSelectorTerms</th><th>nodeSelector</th><th>Tolerations</th></tr></thead><tbody><tr><td>Calico</td><td><code>beta.kubernetes.io/os:NotIn:windows</code></td><td>none</td><td>- <code>NoSchedule:Exists</code><br>- <code>NoExecute:Exists</code><br>- <code>CriticalAddonsOnly:Exists</code></td></tr><tr><td>Flannel</td><td><code>beta.kubernetes.io/os:NotIn:windows</code></td><td>none</td><td>- <code>operator:Exists</code></td></tr><tr><td>Canal</td><td><code>beta.kubernetes.io/os:NotIn:windows</code></td><td>none</td><td>- <code>NoSchedule:Exists</code><br>- <code>NoExecute:Exists</code><br>- <code>CriticalAddonsOnly:Exists</code></td></tr><tr><td>Weave</td><td><code>beta.kubernetes.io/os:NotIn:windows</code></td><td>none</td><td>- <code>NoSchedule:Exists</code><br>- <code>NoExecute:Exists</code></td></tr><tr><td>CoreDNS</td><td><code>node-role.kubernetes.io/worker:Exists</code></td><td><code>beta.kubernetes.io/os:linux</code></td><td>- <code>NoSchedule:Exists</code><br>- <code>NoExecute:Exists</code><br>- <code>CriticalAddonsOnly:Exists</code></td></tr><tr><td>kube-dns</td><td>- <code>beta.kubernetes.io/os:NotIn:windows</code><br>- <code>node-role.kubernetes.io/worker</code> <code>Exists</code></td><td>none</td><td>- <code>NoSchedule:Exists</code><br>- <code>NoExecute:Exists</code><br>- <code>CriticalAddonsOnly:Exists</code></td></tr><tr><td>nginx-ingress</td><td>- <code>beta.kubernetes.io/os:NotIn:windows</code><br>- <code>node-role.kubernetes.io/worker</code> <code>Exists</code></td><td>none</td><td>- <code>NoSchedule:Exists</code><br>- <code>NoExecute:Exists</code></td></tr><tr><td>metrics-server</td><td>- <code>beta.kubernetes.io/os:NotIn:windows</code><br>- <code>node-role.kubernetes.io/worker</code> <code>Exists</code></td><td>none</td><td>- <code>NoSchedule:Exists</code><br>- <code>NoExecute:Exists</code></td></tr></tbody></table><h1>Tolerations</h1><p><em>Available as of v1.2.4</em></p><p>Tolerations can be configured per add-on and apply to Deployment resources. The configured tolerations will replace the existing tolerations so make sure you configure all the tolerations you need. See the specific add-on doc pages for more information.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rke1-docs/edit/main/docs/config-options/add-ons/add-ons.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-10-11T16:58:25.000Z">10/11/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/rke1-docs/assets/js/runtime~main.dd12ace3.js"></script>
<script src="/rke1-docs/assets/js/main.7e5028ef.js"></script>
</body>
</html>